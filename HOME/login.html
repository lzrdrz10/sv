<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8"/>
<meta name="google-adsense-account" content="ca-pub-5488063407481298">
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="LZPLAY">
<meta name="description" content="Accede a LZPLAY, tu plataforma de entretenimiento personalizada.">
<title>LZPLAY - Iniciar Sesi√≥n</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
<style>
@import url('https://fonts.googleapis.com/css2?family=Amazon+Ember:wght@400;700&display=swap');

:root {
  --primary-color: #00a8e1;
  --primary-hover: #0077a3;
  --accent-color: #ffc400;
  --accent-hover: #e6ac00;
}

body {
  font-family: 'Amazon Ember', Arial, sans-serif;
  background: #0b0b0b;
  color: #fff;
  margin: 0;
  overflow-x: hidden;
}

/* Fondo din√°mico con blur */
.background {
  position: fixed;
  inset: 0;
  overflow: hidden;
  z-index: -1;
}
.background img {
  position: absolute;
  width: 100%;
  height: 100%;
  object-fit: cover;
  opacity: 0;
  transform: scale(1);
  filter: brightness(0.6) blur(2px);
  transition: opacity 1s ease-in-out, transform 12s linear;
}
.background img.active {
  opacity: 1;
  transform: scale(1.1);
}

.overlay {
  position: fixed;
  inset: 0;
  background: linear-gradient(to bottom, rgba(0,0,0,0.6), rgba(0,0,0,0.9));
  z-index: 0;
}

/* Avatar estilo Prime Video */
.avatar-container {
  position: relative;
  display: inline-block;
}
.avatar-glow {
  border-radius: 50%;
  border: 4px solid #fff;
  box-shadow: 0 0 20px rgba(0,168,225,0.7), 0 0 40px rgba(0,168,225,0.5);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.avatar-glow:hover {
  transform: scale(1.08);
  box-shadow: 0 0 30px rgba(0,168,225,0.9), 0 0 60px rgba(0,168,225,0.7);
}

/* Icono editar avatar redise√±ado */
.edit-icon {
  position: absolute;
  bottom: 8px;
  right: 8px;
  width: 26px;
  height: 26px;
  background: rgba(0,168,225,0.9);
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 12px;
  color: #fff;
  border: 1px solid rgba(255,255,255,0.8);
  box-shadow: 0 2px 6px rgba(0,0,0,0.5);
  cursor: pointer;
  transition: transform 0.25s ease, background 0.25s ease;
}
.edit-icon:hover {
  transform: scale(1.15);
  background: var(--primary-hover);
}

/* Nombre y saludo estilo Prime */
.nombre-prime {
  font-size: 2.5rem;
  font-weight: 700;
  color: #fff;
  text-shadow: 2px 2px 10px rgba(0,0,0,0.7);
  letter-spacing: 1px;
}
.subtitulo-prime {
  font-size: 1.2rem;
  color: #ddd;
  margin-top: 6px;
}

/* Botones estilo Prime Video moderno */
button {
  font-weight: 600;
  border-radius: 6px;
  padding: 14px 0;
  font-size: 1.1rem;
  cursor: pointer;
  position: relative;
  overflow: hidden;
  transition: all 0.3s ease;
}
.bg-primary {
  background: linear-gradient(90deg, #00a8e1, #0077a3);
  color: #fff;
}
.bg-primary:hover {
  background: linear-gradient(90deg, #0077a3, #00a8e1);
  transform: translateY(-2px);
}
.border-accent {
  border: 2px solid var(--accent-color);
  color: var(--accent-color);
}
.border-accent:hover {
  background: var(--accent-hover);
  color: #fff;
  transform: translateY(-2px);
}

/* Responsive */
@media (max-width: 640px) {
  .nombre-prime { font-size: 2rem; }
  .subtitulo-prime { font-size: 1rem; }
  .avatar-glow { width: 120px; height: 120px; }
  .edit-icon { width: 22px; height: 22px; font-size: 11px; }
}
</style>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PC9JETB0VP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-PC9JETB0VP');
</script>
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5488063407481298"
     crossorigin="anonymous"></script>
</head>
<body class="flex flex-col justify-center items-center min-h-screen relative">

<!-- Fondo din√°mico -->
<div class="background" id="backgroundSlider" aria-hidden="true">
  <img src="https://image.tmdb.org/t/p/original/ApRxyHFuvv5yghedxXPJSm9FEDe.jpg" class="active" alt="Fondo 1">
  <img src="https://image.tmdb.org/t/p/original/qNBAXBIQlnOThrVvA6mA2B5ggV6.jpg" alt="Fondo 2">
  <img src="https://image.tmdb.org/t/p/original/r7XifzvtezNt31ypvsmb6Oqxw49.jpg" alt="Fondo 3">
  <img src="https://image.tmdb.org/t/p/original/fCayJrkfRaCRCTh8GqN30f8oyQF.jpg" alt="Fondo 4">
</div>
<div class="overlay" aria-hidden="true"></div>

<main class="flex flex-col items-center z-10 text-center space-y-6 px-6">


  <div class="avatar-container">
    <img id="avatarIcono" class="avatar-glow w-40 h-40 md:w-56 md:h-56 object-cover" src="https://via.placeholder.com/200" alt="Avatar del usuario">
    <a href="iconos.html" class="edit-icon" aria-label="Editar avatar"><i class="fas fa-pencil-alt"></i></a>
  </div>
  <h1 id="nombreUsuario" class="nombre-prime">Invitado</h1>
  <p class="subtitulo-prime" aria-live="polite">¬°Bienvenido de nuevo!</p>

  <div class="flex flex-col gap-4 w-full max-w-sm mt-6">
    <button id="btnLogin" class="bg-primary w-full" aria-label="Iniciar sesi√≥n en LZPLAY">Ingresar</button>
    <button id="btnCompartir" class="border-accent w-full" aria-label="Compartir LZPLAY">Compartir</button>
  </div>
</main>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const nombreUsuario = document.getElementById('nombreUsuario');
  const avatar = document.getElementById('avatarIcono');
  const subtitulo = document.querySelector('.subtitulo-prime');
  const backgroundSlider = document.getElementById('backgroundSlider');
  const btnLogin = document.getElementById('btnLogin');
  const btnCompartir = document.getElementById('btnCompartir');

  const DEFAULT_AVATAR = 'https://i.pinimg.com/736x/91/86/1b/91861b749841221d52122f0c2933d8a6.jpg';
  const LOGIN_URL = '../index.html';
  const SHARE_URL = 'https://escargar.lzplayhd.online/';
  const TOKEN = btoa('UserLzPlay');
  const SLIDE_INTERVAL = 4000;

  // Preload images
  const fondos = backgroundSlider.querySelectorAll('img');
  fondos.forEach(img => new Image().src = img.src);

  let index = 0;
  fondos[index].classList.add('active');

  function changeSlide() {
    fondos.forEach((img) => { img.classList.remove('active'); img.style.transform='scale(1)'; });
    index = (index + 1) % fondos.length;
    fondos[index].classList.add('active');
  }

  let sliderInterval = setInterval(changeSlide, SLIDE_INTERVAL);
  backgroundSlider.addEventListener("mouseenter", () => clearInterval(sliderInterval));
  backgroundSlider.addEventListener("mouseleave", () => { sliderInterval = setInterval(changeSlide, SLIDE_INTERVAL); });

  function loadUserProfile() {
    try {
      const nombreGuardado = localStorage.getItem('nombrePerfil');
      if (nombreGuardado?.trim()) nombreUsuario.textContent = nombreGuardado.trim();
      avatar.src = localStorage.getItem('iconoUsuario') || DEFAULT_AVATAR;
      avatar.onerror = () => { avatar.src = DEFAULT_AVATAR; };
    } catch (error) { console.error(error); }
  }

  function setDynamicGreeting() {
    const now = new Date();
    const hour = now.getHours();
    let greeting = '¬°Buenas noches!';
    if (hour >=5 && hour < 12) greeting='¬°Buenos d√≠as!';
    else if(hour >=12 && hour <18) greeting='¬°Buenas tardes!';
    if(subtitulo) subtitulo.textContent = `${greeting} ¬øQu√© veremos hoy?`;
  }

  function handleLogin() {
    try { localStorage.setItem('accessToken', JSON.stringify({ token: TOKEN, created: Date.now() }));
      window.location.href = LOGIN_URL; 
    } catch (e){ console.error(e); alert('Error al iniciar sesi√≥n.'); }
  }

  async function handleShare() {
    try {
      if(navigator.share) await navigator.share({ title:'LZPLAY', text:'¬°Mira este sitio genial!', url: SHARE_URL });
      else { await navigator.clipboard.writeText(SHARE_URL); alert('Enlace copiado!'); }
    } catch(e){ console.error(e); alert('Error al compartir.'); }
  }

  loadUserProfile();
  setDynamicGreeting();

  btnLogin.addEventListener('click', handleLogin);
  btnCompartir.addEventListener('click', handleShare);
});

(function(){
  var WORKER_URL = "lzplayvotos.thexxx880.workers.dev/"; // <- reemplaza por tu URL exacta
  var modal = document.getElementById("lzvote_modal");
  var btnSi = document.getElementById("lzvote_btnSi");
  var btnNo = document.getElementById("lzvote_btnNo");
  var resultado = document.getElementById("lzvote_resultado");
  var LS_KEY = "lzvote_usuarioVoto";

  // Mostrar modal si no ha votado
  if (!localStorage.getItem(LS_KEY)) {
    modal.classList.remove("hidden");
    modal.classList.add("flex");
  } else {
    // si ya vot√≥, opcional: mostrar resultados al cargar
    fetchResultados();
  }

  btnSi.addEventListener("click", function(){ votar("si"); });
  btnNo.addEventListener("click", function(){ votar("no"); });

  async function votar(opcion) {
    if (localStorage.getItem(LS_KEY)) return; // doble seguridad

    try {
      // llamar al worker (CORS ya habilitado)
      var r = await fetch(WORKER_URL + "?opcion=" + opcion, { method: "GET" });
      var j = await r.json();
      if (j.ok) {
        localStorage.setItem(LS_KEY, opcion);
        actualizarUI(j.votos);
        cerrarModal();
      } else {
        console.error("Error voto:", j);
        alert("Ocurri√≥ un error al registrar tu voto. Intenta de nuevo.");
      }
    } catch (e) {
      console.error(e);
      alert("Error de conexi√≥n. Intenta m√°s tarde.");
    }
  }

  async function fetchResultados() {
    try {
      var r = await fetch(WORKER_URL + "?opcion=si", { method: "OPTIONS" }); // preflight no necesario, mejor hacemos GET de lectura
      // mejor hacer GET para leer: pero worker no tiene endpoint solo-lectura; usamos la misma ruta sin modificar contadores
      // Para leer sin incrementar, hacemos una llamada especial: ?opcion=leer (si quieres), pero ahora no la implementamos.
      // En este script haremos una petici√≥n GET simulando lectura: mejor llamar al Worker con opcion=si y no incrementar no es posible.
      // Por eso, para obtener resultados sin votar, te recomiendo crear un endpoint de solo lectura en el Worker.
    } catch(e) {
      // no hacemos nada; la lectura se maneja al votar
      console.log("No se obtuvo resultados de lectura (a√∫n).");
    }
  }

  function actualizarUI(votos) {
    resultado.innerText = `Resultados actuales: üëç ${votos.si} votos | üëé ${votos.no} votos`;
  }

  function cerrarModal() {
    modal.classList.add("hidden");
    modal.classList.remove("flex");
  }

})();
</script>
</body>
</html>
