<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Buscador</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --card: rgba(16,16,16,0.85); 
  --text: #f5f5f5;
  --muted: #c0c0c0;
  --accent: #00e676;
  --border: rgba(255, 255, 255, 0.1);
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: "Poppins", sans-serif;
  color: var(--text);
  display: flex;
  flex-direction: column;
  align-items: center;
  min-height: 100vh;
  overflow-x: hidden;
  background: url("https://cdn.masmovil.es/embed/17ebde02ab71c25777ff0b0ddc4fb7a452e1676888762/netflix.jpg?imagick=1&size=1000") no-repeat center center fixed;
  background-size: cover;
  position: relative;
}

body::before {
  content: "";
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.65);
  z-index: -1;
}

.search-container {
  position: sticky;
  top: 16px;
  width: 90%;
  max-width: 800px;
  background: rgba(0,0,0,0.6);
  backdrop-filter: blur(12px);
  border-radius: 20px;
  box-shadow: 0 6px 20px rgba(0,0,0,0.5);
  z-index: 20;
  padding: 14px 20px;
  display: flex;
  justify-content: center;
  align-items: center;
  margin-top: 10px;
}

.search-box {
  display: flex;
  align-items: center;
  background: rgba(18,18,18,0.9);
  border: 1px solid var(--border);
  border-radius: 30px;
  padding: 10px 16px;
  flex: 1;
  max-width: 100%;
  box-shadow: 0 4px 15px rgba(0,0,0,0.3);
}

.search-box input {
  background: none;
  border: none;
  outline: none;
  color: var(--text);
  font-size: 16px;
  flex: 1;
  padding: 6px 8px;
}

.search-box svg {
  width: 24px;
  height: 24px;
  fill: var(--text);
  opacity: 0.8;
  margin-right: 8px;
}

/* Contenedor resultados */
.results {
  width: 100%;
  max-width: 1200px;
  padding: 16px;
  display: flex;
  flex-direction: column;
  gap: 14px;
  font-size: 16px;
  text-align: center;
  color: var(--muted);
  min-height: 80px;
}

/* Tarjetas */
.card {
  display: flex;
  flex-direction: column;
  background: var(--card);
  backdrop-filter: blur(12px);
  border-radius: 12px;
  overflow: hidden;
  border: 1px solid var(--border);
  transition: transform .15s ease, box-shadow .3s ease, opacity .3s ease;
  cursor: pointer;
  opacity: 0;
  transform: translateY(15px);
  box-shadow: 0 4px 15px rgba(0,0,0,0.5);
  width: 100%;
  max-width: 180px;
  height: auto;
}

.card.show {
  opacity: 1;
  transform: translateY(0);
}

.card:hover {
  transform: scale(1.03);
  box-shadow: 0 10px 30px rgba(0,0,0,0.7);
}

.card img {
  width: 100%;
  height: auto;
  aspect-ratio: 2/3; 
  object-fit: cover;
}

.card-content {
  padding: 8px 10px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  flex: 1;
}

.card h3 {
  font-size: 15px;
  font-weight: 600;
  margin-bottom: 4px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.card p {
  color: var(--muted);
  font-size: 13px;
  line-height: 1.2;
}

/* Responsivo para PC / tablets: grid vertical */
@media (min-width: 700px) {
  .results {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    gap: 16px;
    justify-items: center;
    align-items: start;
  }
  .card {
    flex-direction: column;
    max-width: 180px;
  }
}

/* Contenedor resultados móviles */
@media (max-width: 699px) {
  .results {
    display: flex;
    flex-direction: column;
    gap: 10px;
    align-items: center;
    padding: 8px;
  }

  .card {
    display: flex;
    flex-direction: row;
    width: 95%;
    max-width: 95%;
    height: 120px; /* altura menor para móviles */
    background: var(--card);
    border-radius: 12px;
    overflow: hidden;
  }

  .card img {
    width: auto;          /* ancho automático según proporción */
    height: 100%;         /* ocupa toda la altura de la tarjeta */
    aspect-ratio: 2/3;    /* mantiene proporción típica de posters */
    object-fit: cover;
    border-radius: 8px 0 0 8px;
    flex-shrink: 0;
  }

  .card-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: 0 12px;
  }

  .card h3 {
    font-size: 15px;
    white-space: normal;
    overflow: hidden;
  }

  .card p {
    font-size: 12px;
    margin-top: 4px;
  }
}

</style>
<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-PC9JETB0VP"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-PC9JETB0VP');
</script>
</head>
<body>

<div class="search-container">
  <div class="search-box">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 21l-4.35-4.35M11 18a7 7 0 1 1 0-14 7 7 0 0 1 0 14z" stroke="#fff" stroke-width="1.5" fill="none" stroke-linecap="round"/></svg>
    <input type="text" id="searchInput" placeholder="Buscar...">
  </div>
</div>

<div class="results" id="results">
  <center><p id="welcomeMessage">Empieza a escribir para buscar...</p></center>
</div>

<script>
var githubURL = "https://raw.githubusercontent.com/lzrdrz10/sv/main/HOME/Buscador.html";
var data = [];

var messages = [
  "¡Explora tu contenido favorito!",
  "¡Encuentra películas y series increíbles!",
  "¡Disfruta viendo lo que más te gusta!",
  "¡Cada búsqueda es una aventura!",
  "¡Descubre nuevas historias!",
  "¡Bienvenido, comienza a explorar!"
];

var msgIndex = 0;
var welcomeEl = document.getElementById("welcomeMessage");

function rotateMessages() {
  welcomeEl.textContent = messages[msgIndex];
  msgIndex = (msgIndex + 1) % messages.length;
}
setInterval(rotateMessages, 4000);

fetch(githubURL)
  .then(res => res.text())
  .then(html => {
    var parser = new DOMParser();
    var doc = parser.parseFromString(html, "text/html");
    var items = doc.querySelectorAll("li");

    items.forEach(li => {
      var a = li.querySelector("a");
      var img = li.querySelector("img");
      var spans = li.querySelectorAll("span.hidden");
      if (a && img && spans.length >= 2) {
        var title = spans[0].textContent.trim();
        var desc = (spans[0].textContent + " " + spans[1].textContent).trim();
        var type = a.getAttribute("href").includes("/Peliculas/") ? "Película" : "Serie";

        data.push({
          url: a.getAttribute("href"),
          poster: img.getAttribute("src"),
          title: title,
          type: type,
          desc: desc
        });
      }
    });
  })
  .catch(err => {
    console.error("Error al cargar:", err);
    welcomeEl.textContent = "Error al cargar el contenido.";
  });

function debounce(func, delay) {
  var timeout;
  return function(...args) {
    clearTimeout(timeout);
    timeout = setTimeout(() => func.apply(this, args), delay);
  };
}

document.getElementById("searchInput").addEventListener("input", debounce(function() {
  var query = this.value.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
  var container = document.getElementById("results");

  if (query.length === 0) {
    container.innerHTML = '<p id="welcomeMessage">' + messages[msgIndex] + '</p>';
    return;
  }

  var filtered = data.filter(item => {
    var queryWords = query.split(/\s+/).filter(Boolean);
    var text = item.desc.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
    return queryWords.every(word => text.includes(word));
  });

  renderResults(filtered);
}, 200));

function renderResults(data) {
  var container = document.getElementById("results");
  container.innerHTML = "";

  if (data.length === 0) {
    container.innerHTML = "<p style='text-align:center;color:var(--muted);'>Sin resultados.</p>";
    return;
  }

  data.forEach((item, index) => {
    var card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `
      <img src="${item.poster}" alt="${item.title}">
      <div class="card-content">
        <h3 title="${item.title}">${item.title}</h3>
        <p>${item.type}</p>
      </div>
    `;
    card.onclick = () => window.location.href = item.url;
    container.appendChild(card);

    setTimeout(() => card.classList.add("show"), index * 50);
  });
}
</script>

</body>
</html>
